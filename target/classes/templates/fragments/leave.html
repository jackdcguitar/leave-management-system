<section th:fragment="content">
  <h4 class="mb-3">請假管理</h4>

  <form th:object="${leaveRequest}" th:action="@{/leave/apply}" method="post" class="row g-3 mb-4">
    <div class="col-md-4">
      <label for="leaveType" class="form-label">請假種類</label>
      <select class="form-select" id="leaveType" name="leaveType" th:field="*{leaveType}" required>
        <option value="">-- 請選擇 --</option>
        <option value="ANNUAL">特休</option>
        <option value="SICK">病假</option>
        <option value="PERSONAL">事假</option>
      </select>
    </div>
    <div class="col-md-4">
      <label for="startDate" class="form-label">開始時間</label>
      <input type="datetime-local" class="form-control" id="startDate" name="startDate" 
             th:field="*{startDate}" required>
    </div>
    <div class="col-md-4">
      <label for="endDate" class="form-label">結束時間</label>
      <input type="datetime-local" class="form-control" id="endDate" name="endDate" 
             th:field="*{endDate}" required>
    </div>
    <div class="col-12">
      <label for="reason" class="form-label">事由</label>
      <input type="text" class="form-control" id="reason" name="reason" 
             placeholder="簡述請假原因" th:field="*{reason}" required>
    </div>
    <div class="col-12">
      <button class="btn btn-primary" type="submit">送出申請</button>
    </div>
  </form>

  <div class="card">
    <div class="card-body">
      <h6 class="card-title mb-3">我的請假紀錄</h6>
      <table class="table table-sm">
        <thead>
          <tr>
            <th>類型</th>
            <th>起</th>
            <th>迄</th>
            <th>事由</th>
            <th>狀態</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="leave : ${leaves}">
            <td th:text="${leave.leaveType == 'ANNUAL' ? '特休' : (leave.leaveType == 'SICK' ? '病假' : '事假')}"></td>
            <td th:text="${#temporals.format(leave.startDate, 'yyyy-MM-dd HH:mm')}"></td>
            <td th:text="${#temporals.format(leave.endDate, 'yyyy-MM-dd HH:mm')}"></td>
            <td th:text="${leave.reason}"></td>
            <td>
              <span th:class="${leave.status == 'APPROVED' ? 'badge bg-success' : (leave.status == 'REJECTED' ? 'badge bg-danger' : 'badge bg-warning')}" 
                    th:text="${leave.status == 'PENDING' ? '審核中' : (leave.status == 'APPROVED' ? '已核准' : '已拒絕')}">
              </span>
            </td>
          </tr>
          <tr th:if="${#lists.isEmpty(leaves)}">
            <td colspan="5" class="text-center">尚無請假記錄</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</section>
